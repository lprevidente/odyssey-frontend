<ion-modal
  [isOpen]="isModalOpen()"
  (willDismiss)="close()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start"></ion-buttons>
        <ion-title>Explore Destination</ion-title>

        <!-- Close button -->
        <ion-buttons slot="end">
          <ion-button
            (click)="close()"
            [strong]="true">
            Close
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="ion-padding">
      <p class="text-gray-800 dark:text-gray-400 text-justify">
        Input Your Favorite Places to Enrich Every Traveler's Journey
      </p>

      <form
        (ngSubmit)="saveActivity()"
        [formGroup]="form"
        class="form">
        <!-- Name -->
        <ion-input
          class="mt-4"
          mode="md"
          fill="outline"
          label="Label"
          labelPlacement="stacked"
          type="text"
          formControlName="name"
          placeholder="Walking in Odyssey Park">
        </ion-input>

        <!-- From -->
        <app-poi-autocomplete
          label="Place"
          formControlName="place"
          placeholder="Search for Odyssey Park"
          [latitude]="place().position.lat"
          [longitude]="place().position.lng">
        </app-poi-autocomplete>

        <!-- Reservation -->
        <ion-toggle
          formControlName="reservation"
          class="w-full text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          mode="md">
          Have you booked tickets?
        </ion-toggle>

        @if (form.controls["reservation"].value) {
          <div class="mt-2 flex flex-row items-center">
            <label
              class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 flex-grow">
              At what time?
            </label>
            <ion-datetime-button
              mode="md"
              datetime="time">
            </ion-datetime-button>

            <ion-modal [keepContentsMounted]="true">
              <ng-template>
                <ion-datetime
                  presentation="time"
                  formControlName="time"
                  id="time">
                </ion-datetime>
              </ng-template>
            </ion-modal>
          </div>

          <div class="mt-4">
            <label
              class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="tickets">
              Tickets
            </label>
            <input
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              id="tickets"
              placeholder="Upload your tickets"
              multiple
              accept=".pdf"
              type="file" />
            <p class="text-xs text-gray-500 dark:text-gray-400">
              You can only upload PDF files.
            </p>
          </div>
        }

        <!-- Note -->
        <ion-textarea
          class="mt-2.5"
          rows="3"
          mode="md"
          labelPlacement="stacked"
          label="Add a note"
          formControlName="notes"
          fill="outline"
          placeholder="Brings some food">
        </ion-textarea>

        <!-- Link -->
        <ion-input
          mode="md"
          fill="outline"
          label="Link to the place"
          labelPlacement="stacked"
          type="text"
          formControlName="link"
          placeholder="https://odysseypark.com">
          <ion-icon
            name="clipboard"
            slot="end"
            (click)="pasteFromClipboard()">
          </ion-icon>
        </ion-input>

        <ion-button
          type="submit"
          expand="block"
          class="mt-4"
          color="primary">
          {{ isUpdating ? "Update" : "Add" }}
        </ion-button>
      </form>
    </ion-content>
  </ng-template>
</ion-modal>
